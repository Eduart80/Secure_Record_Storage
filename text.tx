 "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7InVzZXJuYW1lIjoiTW9vbiBEYXkiLCJlbWFpbCI6InRlc3QxMkB0ZXN0LmNvbSIsIl9pZCI6IjY5NzEyM2UxMjVlYWQyNzgwZmMyYWZmOCJ9LCJpYXQiOjE3NjkwMjI0NzQsImV4cCI6MTc2OTAyOTY3NH0.4LzNfPZ_AGck1FNa46M7Qc_rzRnbb6N6mSrYLsh8VWA",

Secure Record Storage
Scenario
You have been given a pre-existing “Notes” API. It has full CRUD (Create, Read, Update, Delete) functionality and is protected by authentication middleware, meaning only logged-in users can access the endpoints. However, there’s a significant flaw: any authenticated user can view, update, or delete any note, regardless of who created it.

Your task is to implement authorization logic to ensure that users can only access and manage the notes they personally own.

Instructions
For this lab, you will be provided with a starter codebase. The starter code contains a simple Express API with user authentication and a /api/notes endpoint.

Task 1: Associate Notes with Users
Update the Note Model: Add a new field to the Note schema (models/Note.js). This field should be named user (or owner) and should store the ObjectId of the user who created the note. It should be a required reference to the User model.


// Example snippet for the Note schema
user: {
  type: Schema.Types.ObjectId,
  ref: 'User',
  required: true,
}
Modify the “Create Note” Route: In your notes route file (routes/api/notes.js), find the POST / route. When a new note is created, you must associate it with the currently logged-in user. 
The authenticated user’s data should be available on req.user from the authentication middleware. Save the user’s _id to the new note’s user field.

Task 2: Implement Ownership-Based Authorization
Filter “Get All Notes”: Modify the GET / route. Instead of returning all notes in the database, it should now only return the notes where the user field matches the _id of the currently authenticated user (req.user._id).

Secure “Update Note”: Modify the PUT /:id route. Before updating a note, you must first find the note by its ID. Then, check if the user field on that note matches the authenticated user’s _id.

If they match, proceed with the update.
If they do not match, return a 403 Forbidden status with an error message like "User is not authorized to update this note."
Secure “Delete Note”: Modify the DELETE /:id route. Similar to the update route, you must check for ownership before deleting a note.

Find the note by its ID.
If the user is the owner, delete the note.
If the user is not the owner, return a 403 Forbidden status with an appropriate error message.
(Optional) Secure “Get Single Note”: If you have a GET /:id route, apply the same ownership check there as well.

Acceptance Criteria
The Note model includes a required user field referencing the User model.
The POST /api/notes route correctly assigns the logged-in user’s ID to the new note.
The GET /api/notes route only returns notes created by the currently logged-in user.
The PUT /api/notes/:id and DELETE /api/notes/:id routes prevent users from modifying or deleting notes they do not own, returning a 403 status code.
The API functions correctly for all valid requests.